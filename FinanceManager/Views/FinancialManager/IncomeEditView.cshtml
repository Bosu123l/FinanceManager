@model Domain.Models.Income

@{
    ViewBag.Title = "Edit";
}

@Html.AntiForgeryToken()

<Table class="table-bordered">
    <tr>
        <th>Amount:</th>
        <th>Date:</th>
        <th>Type:</th>
        <th>Description:</th>
        <th>Action</th>
    </tr>

    @foreach (Domain.Models.Income income in ViewBag.Income)
    {
        using (Html.BeginForm("EditIncomingAmount", "FinancialManager", new { ID = income.ID }))
        {
            <tr>
                <th>

                    @Html.EditorFor(x => x.Amount, ViewData.TemplateInfo.FormattedModelValue.ToString(), new { htmlAttributes = new { @class = "form-control", @Value = string.Format("{0}", income.Amount) } })
                </th>
                <th>
                    @Html.Label(income.Date.Value.ToString("D"))
                    @Html.EditorFor(x => x.Date, new { htmlAttributes = new { @Value = income.Date.Value.ToString("d"), @class = "form-control", @Type = "date" } })
                </th>
                <th>
                    @{
                        List<SelectListItem> elements = new List<SelectListItem>();

                        foreach (Domain.Models.SourceOfAmount type in ViewBag.IncomeType)
                        {
                            if (type.Name.Equals(income.Source.Name))
                            {
                                elements.Add(new SelectListItem()
                                {
                                    Value = type.ID.ToString(),
                                    Text = type.Name,
                                    Selected = true

                                });
                            }
                            else
                            {
                                elements.Add(new SelectListItem()
                                {
                                    Value = type.ID.ToString(),
                                    Text = type.Name,

                                });
                            }

                        }

                        @Html.DropDownListFor(x => x.SourceID, new List<SelectListItem>(elements), new { @class = "form-control", @Default = income.Source.Name })
                    }
                </th>
                <th>@Html.EditorFor(x => x.Description, new { htmlAttributes = new { @Value = income.Description != null ? income.Description : string.Empty, @class = "form-control" } }) </th>
                <th>
                    <table>
                        <tr>
                            <th>

                                <button class="form-control col-lg-2" name="Edit" type="submit">Edytuj</button>
                            </th>
                            <th>
                                <button class="form-control col-lg-2" name="delete" type="submit">Usuń</button>
                            </th>
                        </tr>
                    </table>
                </th>
            </tr>
                            }

                        }

    <tr>
        <th>
            @{
                Html.RenderPartial("AddIncomimngTypeView");
            }
        </th>
    </tr>
</Table>